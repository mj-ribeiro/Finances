B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
beta1 = B[1]
beta2 = B[2]
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
cat('G:', G, 'L:', L, '\n')
H
y2 = c(2.850, 3.105, 5.693, 8.101, 10.387, 3, 44, 5.5, 0.8)
x2 = c(3, 6, 12, 3, 1.4, 0.9, -1, 22, 4.3)
sig2 = 1e6
T = length(x2)
beta1 = 0.11
beta2 = -100
B = rbind(beta1, beta2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
matrix = ( data=c(−4,  0.228, 0.228, -0.547), ncol=2, nrow=2)
matrix = (data=c(−4,  0.228, 0.228, -0.547), ncol=2, nrow=2)
matrix = (c(−4,  0.228, 0.228, -0.547), ncol=2, nrow=2 )
m = matrix(c(−4,  0.228, 0.228, -0.547), ncol=2, nrow=2)
m2 = matrix(c(0.931, 0.280), ncol=1, nrow=2)
m2 = matrix(c(0.931, 0.280), ncol=1, nrow=2)
th = matrix(c(0.5, 1.5), ncol=1, nrow=2)
th - solve(m1)*m2
m1 = matrix(c(−4,  0.228, 0.228, -0.547), ncol=2, nrow=2)
m2 = matrix(c(0.931, 0.280), ncol=1, nrow=2)
th = matrix(c(0.5, 1.5), ncol=1, nrow=2)
th = matrix(c(0.5, 1.5), ncol=1, nrow=2)
th - solve(m1)%*%m2
m1
m1 = matrix(c(−4,  -0.228, -0.228, -0.547), ncol=2, nrow=2)
m2 = matrix(c(0.931, 0.280), ncol=1, nrow=2)
th = matrix(c(0.5, 1.5), ncol=1, nrow=2)
th - solve(m1)%*%m2
y2 = c(2.850, 3.105, 5.693, 8.101, 10.387, 3, 44, 5.5, 0.8)
x2 = c(3, 6, 12, 3, 1.4, 0.9, -1, 22, 4.3)
sig2 = 1e6
T = length(x2)
beta1 = 0.11
beta2 = -100
B = rbind(beta1, beta2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
while (tol > min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
sig2 = 1.5
T = length(x2)
beta1 = 0.11
beta2 = -100
B = rbind(beta1, beta2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
beta1 = 0.11
beta2 = 0
B = rbind(beta1, beta2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2*T) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
exp(0.73654)
exp(0.73654)
exp(0.7198)
17^2
289-4*52
4*13
exp(0.248)
exp(0.1528)
exp(0.1523)
source('D:/Git projects/Finance/Finance_R/portfolio.r')
df = data.frame(lapply(assets, get))
colnames(df) = 'ibov'
ret = diff(log(df$ibov))
# get my portfolio returns
my_p = read.csv('portfolio.csv', sep = ';', header = T)[1:2]
my_p$rentabilidade = my_p$rentabilidade/100
my_p$ret = ret
colnames(my_p) = c('data', 'eu', 'ibov')
# make graph
df4 <- melt(data = my_p, id.vars = "data")
ggplot(df4, aes(x = as.Date(data), y = value)) +
scale_x_date(date_labels="%m/%Y",date_breaks  ="2 month") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size=20),
axis.text.y = element_text(size=20),
axis.title.x = element_text(colour = 'black', size=21),
axis.title.y = element_text(colour = 'black', size=21),
legend.title=element_blank(),
legend.text = element_text(colour="black", size = 21),
legend.position="bottom" ) +
geom_line(aes(color = variable, linetype = variable), size=0.8) +
scale_color_manual(values = c("darkred", "steelblue")) +
xlab('Anos') +
ylab('Rendimento')
library(flexdashboard)
library(ggplot2)
library(haven)
library(plyr)
library(plotly)
library(quantmod)
library(reshape2)
assets = c('^BVSP')
get = function(x, d= "2018-03-01"){
z = getSymbols(x, src='yahoo',
from= d,
periodicity = "monthly",
auto.assign = F)[,4]
return(z)
}
# get IBOV
df = data.frame(lapply(assets, get))
colnames(df) = 'ibov'
ret = diff(log(df$ibov))
# get my portfolio returns
my_p = read.csv('portfolio.csv', sep = ';', header = T)[1:2]
my_p$rentabilidade = my_p$rentabilidade/100
my_p$ret = ret
colnames(my_p) = c('data', 'eu', 'ibov')
# make graph
df4 <- melt(data = my_p, id.vars = "data")
View(df4)
View(df4)
assets = c('^BVSP')
get = function(x, d= "2018-03-01"){
z = getSymbols(x, src='yahoo',
from= d,
periodicity = "monthly",
auto.assign = F)[,4]
return(z)
}
# get IBOV
df = data.frame(lapply(assets, get))
colnames(df) = 'ibov'
ret = diff(log(df$ibov))
# get my portfolio returns
my_p = read.csv('portfolio.csv', sep = ';', header = T)[1:2]
my_p$rentabilidade = my_p$rentabilidade/100
my_p$ret = ret
colnames(my_p) = c('data', 'eu', 'ibov')
# make graph
df4 <- melt(data = my_p, id.vars = "data")
colnames(my_p) = c('data', 'Minha carteira', 'IBOV')
# make graph
df4 <- melt(data = my_p, id.vars = "data")
colnames(df4) =  c('data', 'Fator', 'Rendimento')
df4$data =  as.Date(data)
ggplot(df4, aes(x = data, y = Rendimento)) +
scale_x_date(date_labels="%m/%Y",date_breaks  ="2 month") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size=20),
axis.text.y = element_text(size=20),
axis.title.x = element_text(colour = 'black', size=21),
axis.title.y = element_text(colour = 'black', size=21),
legend.title=element_blank(),
legend.text = element_text(colour="black", size = 21),
legend.position="bottom" ) +
geom_line(aes(color = variable, linetype = variable), size=0.8) +
scale_color_manual(values = c("darkred", "steelblue")) +
xlab('Anos') +
ylab('Rendimento')
ggplot(df4, aes(x = data, y = Rendimento)) +
scale_x_date(date_labels="%m/%Y",date_breaks  ="2 month") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size=20),
axis.text.y = element_text(size=20),
axis.title.x = element_text(colour = 'black', size=21),
axis.title.y = element_text(colour = 'black', size=21),
legend.title=element_blank(),
legend.text = element_text(colour="black", size = 21),
legend.position="bottom" ) +
geom_line(aes(color = Fator, linetype = Fator), size=0.8) +
scale_color_manual(values = c("darkred", "steelblue")) +
xlab('Anos') +
ylab('Rendimento')
df4$data =  as.Date(data)
df4$data =  as.Date(df4$data)
ggplot(df4, aes(x = data, y = Rendimento)) +
scale_x_date(date_labels="%m/%Y",date_breaks  ="2 month") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size=20),
axis.text.y = element_text(size=20),
axis.title.x = element_text(colour = 'black', size=21),
axis.title.y = element_text(colour = 'black', size=21),
legend.title=element_blank(),
legend.text = element_text(colour="black", size = 21),
legend.position="bottom" ) +
geom_line(aes(color = Fator, linetype = Fator), size=0.8) +
scale_color_manual(values = c("darkred", "steelblue")) +
xlab('Anos') +
ylab('Rendimento')
ggplot(df4, aes(x = data, y = Rendimento)) +
scale_x_date(date_labels="%m/%Y",date_breaks  ="2 month") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size=20),
axis.text.y = element_text(size=20),
axis.title.x = element_text(colour = 'black', size=21),
axis.title.y = element_text(colour = 'black', size=21),
legend.title=element_blank(),
legend.text = element_text(colour="black", size = 21),
legend.position="bottom" ) +
geom_line(aes(color = Fator, linetype = Fator), size=1) +
scale_color_manual(values = c("darkred", "steelblue")) +
xlab('Anos') +
ylab('Rendimento')
