z = getSymbols(x, src='yahoo',
from= d,
periodicity = "monthly",
auto.assign = F)[,4]
return(z)
}
ativos = c('ITUB4.SA',
'VALE3.SA',
'BBDC4.SA',
'PETR4.SA',
'B3SA3.SA',
'PETR3.SA',
'ABEV3.SA',
'BBAS3.SA',
'ITSA4.SA',
'LREN3.SA',
'JBSS3.SA',
'BBDC3.SA',
'IRBR3.SA',
'GNDI3.SA',
'MGLU3.SA',
'SUZB3.SA',
'BRFS3.SA',
'UGPA3.SA',
'RENT3.SA',
'RAIL3.SA',
'WEGE3.SA',
'BBSE3.SA',
'RADL3.SA',
'VIVT4.SA',
'EQTL3.SA',
'BRDT3.SA',
'GGBR4.SA',
'CCRO3.SA',
'SBSP3.SA',
'LAME4.SA',
'COGN3.SA',
'SULA11.SA',
'AZUL4.SA',
'SANB11.SA',
'BRML3.SA',
'EMBR3.SA',
'HAPV3.SA',
'HYPE3.SA',
'BPAC11.SA',
'NTCO3.SA',
'PCAR4.SA',
'YDUQ3.SA',
'EGIE3.SA',
'CMIG4.SA',
'VVAR3.SA',
'TIMP3.SA',
'BTOW3.SA',
'KLBN11.SA',
'ELET3.SA',
'QUAL3.SA',
'CSAN3.SA',
'TOTS3.SA',
'CIEL3.SA',
'CRFB3.SA',
'CSNA3.SA',
'FLRY3.SA',
'MULT3.SA',
'ELET6.SA',
'CYRE3.SA',
'BRAP4.SA',
'BRKM5.SA',
'TAEE11.SA',
'ENBR3.SA',
'GOAU4.SA',
'MRVE3.SA',
'CVCB3.SA',
'USIM5.SA',
'GOLL4.SA',
'IGTA3.SA',
'HGTX3.SA',
'MRFG3.SA',
'ECOR3.SA',
'SMLS3.SA')
#  Getting assets with date since 2000
know_data = function(z){
k= get_data(z)
s = index(k)[1]
return(s)
}
t = c()
for (i in ativos) {
#  print(know_data(i))
t[i] = know_data(i)
}
View(t)
library(zoo)
out = as.Date(t)
out = sort(out)    # sort by date
out = data.frame(out)
View(out)
sort_names = rownames(out)
sort_names[1:23]  # assets that date begin in 2000-01-01
assets = sort_names[1:23]
df = data.frame(lapply(assets, get_data))
basicStats(df)
for(i in 1:length(df)){
df[ ,i] = ifelse(is.na(df[,i]),
(mean(df[,i], na.rm = T)),
df[,i] )
}
basicStats(df)
View(df)
nl = sum((df[,1]>0)*1)
df = df[-nl,]
nl = sum((df[,1]>0)*1)
ret = data.frame(matrix(nrow =(nl-1), ncol=length(assets)))
for(i in 1:length(assets)){
ret[ ,i] = diff(log(df[,i]))
}
colnames(ret) = assets
View(ret)
cov(ret)
w = runif(length(assets), 0, 1)
w
w = w/sum(w)
w
sum(w)
w.T
t(w)
t(w)%*%cov(ret)%*%w
for(i in 1:1000){
w = runif(length(assets), 0, 1)
w = w/sum(w)
v = t(w)%*%cov(ret)%*%w
}
v = c()
for(i in 1:1000){
w = runif(length(assets), 0, 1)
w = w/sum(w)
v[i] = t(w)%*%cov(ret)%*%w
}
min(v)
v = c()
for(i in 1:1000){
w = runif(length(assets), 0, 1)
w = w/sum(w)
v[i] = t(w)%*%cov(ret)%*%w
}
min(v)
markowitz = function(x){
v = c()
for(i in 1:x){
w = runif(length(assets), 0, 1)
w = w/sum(w)
v[i] = t(w)%*%cov(ret)%*%w
}
cat('A variância mínima é', min(v))
}
markowitz(1000)
cat('A variância mínima é:', round(min(v),4))
assets
View(assets)
assets = c("VALE3.SA", "PETR4.SA", "PETR3.SA", "ABEV3.SA", "BBAS3.SA", "ITSA4.SA",
"LREN3.SA","BBDC3.SA", "BRFS3.SA", "WEGE3.SA", "RADL3.SA", "VIVT4.SA", "SBSP3.SA",
"LAME4.SA","EMBR3.SA", "CMIG4.SA", "VVAR3.SA", "ELET3.SA", "CSNA3.SA", "CYRE3.SA",
"ENBR3.SA","USIM5.SA", "HGTX3.SA")
which(min(v))
which.min(v)
cat('A variância mínima é:', round(min(v), 4))
View(v)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w/sum(w)
v[i] = t(w)%*%cov(ret)%*%w
}
cat('A variância mínima é:', round(min(v), 4))
cat('Os pesos de cada ativo são:', w[(which.min(v)), ])
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('Os pesos de cada ativo são:', w[(which.min(v)), ])
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
cat('Os pesos de cada ativo são:', w[(which.min(v)), ])
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
colnames(pes) = assets
cat('Os pesos de cada ativo no portfólio são:', pes)
}
markowitz(1000)
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
#  colnames(pes) = assets
cat('Os pesos de cada ativo no portfólio são:', pes)
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
#  colnames(pes) = assets
cat('Os pesos de cada ativo no portfólio são:', pes)
return(pes)
}
p  = markowitz(1000)
p
length(p)
colnames(p) = assets
p = t(p)
View(p)
colnames(p) = assets
View(p)
p  = markowitz(1000)
rownames(p) = assets
rownames(p) = t(assets)
p = t(p)
colnames(p) = assets
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
cat('Os pesos de cada ativo no portfólio são:', pes)
return(pes)
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
cat('Os pesos de cada ativo no portfólio são:', pes)
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:')
cat('\n')
cat('\033[1;031m')
knitr:: kable(pes)
}
markowitz(1000)
knitr:: kable(pes)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:')
cat('\n')
cat('\033[1;031m')
knitr:: kable(pes[ ,1:10])
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:')
cat('\n')
cat('\033[1;031m')
cat(pes)
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:', pes)
cat('\n')
cat('\033[1;031m')
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:')
pes
cat('\n')
cat('\033[1;031m')
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:')
print(pes)
cat('\n')
cat('\033[1;031m')
}
markowitz(1000)
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
cat('Os pesos de cada ativo no portfólio são:')
cat('\n')
cat('\033[1;031m')
return(pes)
}
markowitz(1000)
res = markowitz(1000)
View(res)
res = t(res)
View(res)
res = markowitz(10000)
res = t(res)
res = markowitz(10000)
res = t(res)
res = markowitz(100000)
res = t(res)
which.max(res, 3)
which.max(res)
View(res)
sum(res)
res[which.max(res)]
res[which.max(res),]
res[which.min(res), ]
res = markowitz(100000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
markowitz = function(x){
v = c()
w = matrix(nrow = x, ncol = length(assets))
for(i in 1:x){
w[i, ] = runif(length(assets), 0, 1)
w[i, ] = w[i, ]/sum(w[i, ])
v[i] = t(w[i, ])%*%cov(ret)%*%w[i, ]
}
cat('A variância mínima é:', round(min(v), 4))
cat('\n')
pes = w[(which.min(v)), ]
pes = t(pes)
colnames(pes) = assets
pes = data.frame(pes)
return(pes)
}
res = markowitz(100000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(10000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(10000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(10000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(10000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(10000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(10000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(20000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(20000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
res = markowitz(20000)
res = t(res)
res[which.max(res), ]
res[which.min(res), ]
