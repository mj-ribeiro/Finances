plot(fit.norm)
fit.norm <- fitdist(as.vector(-cmts), "exp")
fit.norm <- fitdist(as.vector(cmts), "cauchy")
summary(fit.norm)
plot(fit.norm)
fit.norm <- fitdist(as.vector(cmts), "gamma")
summary(fit.norm)
plot(fit.norm)
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.7, labels = '11 de setembro', cex=0.8)
rep('fernanda', 100)
rep('Fernanda', 100)
rep('Fernanda tUNES', 100)
rep('Fernanda tUNIS', 100)
rep('Fernanda tUNIS', 1000)
rep('Fernanda tUNIS', 1000000)
VaR1 = quantile(cmts, 0.05)
VaR2 = quantile(cmts, 0.01)
par(mfrow=c(1,1))
hist(cm2, breaks = 35, col='lightgreen', probability = T,
main='Histograma para o CMAX mensal \n com 24 janelas')
abline(v=VaR1)
abline(v=VaR2)
abline(v=med)
par(mfrow=c(1,1))
hist(cm2, breaks = 35, col='lightgreen', probability = T,
main='Histograma para o CMAX mensal \n com 24 janelas')
abline(v=VaR1)
abline(v=VaR2)
abline(v=lim)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)  # definition of crise
View(crise)
sum((crise==1)*1)
crise = xts(crise, order.by = data1)
data1 = data[7:length(ibov)]
crise = xts(crise, order.by = data1)
plot(crise)
pos = which(crise==1)   # pegar a posição onde crise== 1
pos
for (c in 1:length(pos)){
crise[(pos[c]-6):pos[c]] = 1
}
plot(crise)
View(crise)
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.7, labels = '11 de setembro', cex=0.8)
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
abline(h=0.8)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.7, labels = '11 de setembro', cex=0.8)
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
abline(h=0.9)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.7, labels = '11 de setembro', cex=0.8)
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
abline(h=0.9)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.6, labels = '11 de setembro', cex=0.8)
windows()
par(mfrow=c(1,1))
plot(cmts, main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
abline(h=0.9)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.6, labels = '11 de setembro', cex=0.8)
test = CMAX(6, length(cmts)-6, cmts)
plot(test)
plot(test, type=l)
plot(test, type='l')
plot(test, type='l')
crise = ifelse(cm2<=lim, 1, 0)  # definition of crise
sum((crise==1)*1)
crise = ifelse(lim<=cm2<=0.9, 0)
crise = ifelse(lim<=cm2<=0.9, 0, 1)
crise = ifelse(lim<=cm2=<0.9, 0, 1)
crise = ifelse(lim<cm2<0.9, 0, 1)
if(cm2<=lim){
crise = 1
}if(lim<=cm2<=0.9){
crise = 0
}else{
crise=2
}
if(cm2<=lim){
crise = 1
}else if(lim<=cm2<=0.9){
crise = 0
}else{
crise=2
}
if(cm2<=lim){
crise = 1
}else if(lim<cm2<0.9){
crise = 0
}else{
crise=2
}
for(i in 1:length(cm2)){
if(cm2[i]<=lim){
crise[i] = 1
}else if(lim<cm2[i]<0.9){
crise[i] = 0
}else{
crise[i]=2
}
}
1:length(cm2)
for(i in 1:length(cm2)){
if(cm2[i]<=lim){
crise[i] = 1
}else if(lim<cm2[i]<0.9){
crise[i] = 0
}else{
crise[i] = 2
}
}
if(cm2[i]<lim){
crise[i] = 1
}else if(lim<cm2[i]<0.9){
crise[i] = 0
}else{
crise[i] = 2
}
if(cm2<lim){
crise[i] = 1
}
if(cm2<lim){
crise = 1
}
if(cm2<lim){
crise = 1
}
crise = ifelse(c(cm2<lim, lim<cm2<0.9), c(1, 0), 2)
crise = ifelse(c(cm2<lim, cm2>0.9), c(1, 2), 0)
table(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
View(df)
crise = ifelse(c(cm2<lim, cm2>0.9), c(1, 2), 0)
View(crise)
crise = xts(crise, order.by = data1)
crise = matrix(nrow = length(cmts))
crise = ifelse(c(cm2<lim, cm2>0.9), c(1, 2), 0)
crise = matrix(nrow = length(cmts))
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
table(crise)
sum((cm2>0.9)*1)
crise = xts(crise, order.by = data1)
plot(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
data = index(cmts)
#----
basicStats(crise)
View(df)
View(df)
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
View(crise)
View(df)
df$date = NULL
View(df)
View(df)
control_train = trainControl(method = 'repeatedcv', number = 10, repeats = 2)    # ten fold
library(caret)   # library to cross validation
model5 = train(crise ~., data=df, trControl = control_train, method='svmRadial')
control_train = trainControl(method = 'cv', number = 10)    # ten fold
model5 = train(crise ~., data=df, trControl = control_train, method='svmRadial')
model5
confusionMatrix(model5)
confusionMatrix(model5)
model4 = train(crise ~., data=df, trControl = control_train, method='nnet', threshold = 0.3)
model4
confusionMatrix(model4)
confusionMatrix(model4)
model6 = train(crise ~., data=df, trControl = control_train, method='knn')
model6
confusionMatrix(model6)
model6$results$Accuracy[2]
model6$results$Accuracy[1]
View(model4)
replace(crise, 2, 0)
replace(crise, 2, 0)
crise = replace(crise, 2, 0)
table(crise)
crise = replace(crise, 2, 0)
table(crise)
model6 = train(crise ~., data=df, trControl = control_train, method='multinom')
model6 = train(crise ~., data=df, trControl = control_train,
method='multinom', type=F)
model6 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='multinom', type=F)
model6
confusionMatrix(model6)
model6 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='knn', type=F)
model6 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='knn')
model6
confusionMatrix(model6)
model4 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='nnet', threshold = 0.3)
confusionMatrix(model4)
table(crise)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
table(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
View(df)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
table(crise)
crise = xts(crise, order.by = data1)
plot(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
View(df)
model3 = train(crise ~., data=df, trControl = control_train, method='multinom', family='binomial')
model3 = train(as.factor(crise) ~., data=df, trControl = control_train, method='multinom', family='binomial')
model3
confusionMatrix(model3)
model5 = train(as.factor(crise) ~., data=df, trControl = control_train, method='svmRadial')
model5
confusionMatrix(model5)
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
pos = which(crise==1)   # pegar a posição onde crise== 1
pos
plot(crise)
plot(crise, type='l')
for(i in 1:length(pos)){
crise[(pos[i]-6):pos[i]] = 1
}
plot(crise, type='l')
table(crise)
library(zoo)
windows()
par(mfrow=c(1,1))
plot(cmts, main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
#xaxt='n'
#axis(1, at=seq(20, 200, 10), labels=seq(2002, 2020, 1))
abline(h=lim)
abline(h=0.9)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.6, labels = '11 de setembro', cex=0.8)
windows()
par(mfrow=c(1,1))
plot(ass.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
abline(h=lim)
abline(h=0.9)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.6, labels = '11 de setembro', cex=0.8)
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
abline(h=lim)
abline(h=0.9)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.6, labels = '11 de setembro', cex=0.8)
prop.table(table(crise))
windows()
par(mfrow=c(1,1))
plot(as.zoo(cmts), main = 'CMAX- W24', ylim=c(0.5, 1),
type='l', ylab='CMAX', xlab='Ano')
abline(h=lim)
abline(h=0.95)
text(as.Date('2008-10-10'), y=0.55, labels = 'Crise \n de 2008', cex=0.8)
text(as.Date('2020-03-10'), y=0.52, labels = 'Crise \n do COVID-19', cex=0.8)
text(as.Date('2000-03-10'), y=0.6, labels = 'Bolha da \n internet', cex=0.8)
text(as.Date('2001-12-9'), y=0.6, labels = '11 de setembro', cex=0.8)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.95, 2, crise)
for(i in 1:length(pos)){
crise[(pos[i]-12):pos[i]] = 1
}
plot(crise, type='l')
table(crise)
prop.table(table(crise))
crise = xts(crise, order.by = data1)
plot(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
View(df)
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
View(df)
model4 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='nnet', threshold = 0.3)
model4
confusionMatrix(model4)
for(i in 1:length(pos)){
crise[(pos[i]-6):pos[i]] = 1
}
pos
for(i in 1:length(pos)){
crise[(pos[i]-6):pos[i]] = 1
}
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.95, 2, crise)
pos = which(crise==1)   # pegar a posição onde crise== 1
pos
for(i in 1:length(pos)){
crise[(pos[i]-6):pos[i]] = 1
}
plot(crise, type='l')
table(crise)
prop.table(table(crise))
crise = xts(crise, order.by = data1)
plot(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
# transform data in data frame
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
model4 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='nnet', threshold = 0.3)
confusionMatrix(model4)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
pos = which(crise==1)   # pegar a posição onde crise== 1
pos
for(i in 1:length(pos)){
crise[(pos[i]-6):pos[i]] = 1
}
plot(crise, type='l')
table(crise)
prop.table(table(crise))
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
# transform data in data frame
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
model4 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='nnet', threshold = 0.3)
View(df)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
pos = which(crise==1)   # pegar a posição onde crise== 1
pos
for(i in 1:length(pos)){
crise[(pos[i]-6):pos[i]] = 1
}
plot(crise, type='l')
table(crise)
prop.table(table(crise))
crise = xts(crise, order.by = data1)
plot(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
# transform data in data frame
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
model4 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='nnet', threshold = 0.3)
confusionMatrix(model4)
crise = matrix(nrow = length(cmts))
crise = ifelse(cm2<lim, 1, 0)
crise = ifelse(cm2>0.9, 2, crise)
pos = which(crise==1)   # pegar a posição onde crise== 1
pos
for(i in 1:length(pos)){
crise[(pos[i]-3):pos[i]] = 1
}
plot(crise, type='l')
table(crise)
prop.table(table(crise))
crise = xts(crise, order.by = data1)
plot(crise)
data = index(cmts)
crise = xts(crise, order.by = data)
cb = cb[data]
vix = vix[data]
data = index(cb)
vix = vix[data]
crise = crise[data]
cdi = cdi[data]
# transform data in data frame
df = data.frame(vix, cb, crise, cdi)
df = data.frame(date=index(index(cb)), coredata(df))
df$date = NULL
model4 = train(as.factor(crise) ~., data=df, trControl = control_train,
method='nnet', threshold = 0.3)
model4
confusionMatrix(model4)
table(crise)
